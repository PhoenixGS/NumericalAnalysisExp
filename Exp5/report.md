# 矩阵特征值计算 

## 上机题1

题目要求矩阵的最大模长的特征值以及对应的特征向量，则使用课上所讲的幂法求解即可。即先初始化一个向量 $x$，然后迭代计算 $x = Ax$，直到 $x$ 收敛。最后计算 $Ax$ 的模长即为特征值，$x$ 即为特征向量。

运行代码 `python P1.py` 后，可以得到如下结果：

```
Eigenvalue of A: 12.254327364587589
Eigenvector of A: [ 0.67401588 -1.          0.88956596]
Correct Eigenvalue of A: 12.254315860794474
Correct Eigenvector of A: [-0.6740206   1.         -0.88955836]
Eigenvalue of B: 98.52160650737164
Eigenvector of B: [-0.60396543  1.         -0.25114387  0.1489578 ]
Correct Eigenvalue of B: 98.52169771010125
Correct Eigenvector of B: [ 0.60397234 -1.          0.25113513 -0.14895345]
```

其中 `Correct` 开头的结果为 `numpy` 库计算得到的正确结果。可以发现使用幂法计算得到的结果与正确结果非常接近。

## 上机题3

使用QR算法来求矩阵 $A$ 的特征值，在每一轮迭代中，使用 `numpy` 中的QR分解将矩阵 $A$ 分解为 $A=QR$，然后计算 $RQ$，直到 $RQ$ 收敛，在这里我们直接将迭代次数设为 $100$ 次。最后 $RQ$ 的对角线元素即为矩阵 $A$ 的特征值。

运行代码 `python P3.py` 后，可以得到如下结果：

```
Correct Eigenvalues of A: [ 1. -1.  1.  1.]
Iteration 0 A:
 [[ 0.5  0.5  0.5  0.5]
 [ 0.5  0.5 -0.5 -0.5]
 [ 0.5 -0.5  0.5 -0.5]
 [ 0.5 -0.5 -0.5  0.5]]
Iteration 10 A:
 [[ 1.00000000e+000 -1.11022302e-016  2.83106871e-014  1.11022302e-016]
 [-7.41529251e-028  1.00000000e+000  5.66213743e-014  3.05311332e-016]
 [-2.84217094e-014 -5.68434189e-014  1.00000000e+000 -2.22044605e-016]
 [ 1.90933523e-149  3.81867045e-149  4.58240455e-149 -1.00000000e+000]]
Iteration 20 A:
 [[ 1.00000000e+000 -1.11023150e-016  2.91037194e-011  1.11022302e-016]
 [-8.46900469e-022  1.00000000e+000  5.82074389e-011  3.05311332e-016]
 [-2.91038305e-011 -5.82076609e-011  1.00000000e+000 -2.22044605e-016]
 [ 7.20922426e-268  1.44184485e-267  1.73298660e-267 -1.00000000e+000]]
Iteration 30 A:
 [[ 1.00000000e+00  1.11022299e-16  1.11022304e-16  1.11022304e-16]
 [-1.22349462e-55  1.00000000e+00 -2.22044600e-16 -3.05311335e-16]
 [ 0.00000000e+00  0.00000000e+00 -1.00000000e+00 -2.22044600e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e+00]]
Iteration 40 A:
 [[ 1.00000000e+00 -1.11022299e-16 -1.11022304e-16 -1.11022304e-16]
 [ 0.00000000e+00  1.00000000e+00 -2.22044600e-16 -3.05311335e-16]
 [ 0.00000000e+00  0.00000000e+00 -1.00000000e+00 -2.22044600e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e+00]]
Iteration 50 A:
 [[ 1.00000000e+00 -1.11022299e-16 -1.11022304e-16 -1.11022304e-16]
 [ 0.00000000e+00  1.00000000e+00 -2.22044600e-16 -3.05311335e-16]
 [ 0.00000000e+00  0.00000000e+00 -1.00000000e+00 -2.22044600e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e+00]]
Iteration 60 A:
 [[ 1.00000000e+00 -1.11022299e-16 -1.11022304e-16 -1.11022304e-16]
 [ 0.00000000e+00  1.00000000e+00 -2.22044600e-16 -3.05311335e-16]
 [ 0.00000000e+00  0.00000000e+00 -1.00000000e+00 -2.22044600e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e+00]]
Iteration 70 A:
 [[ 1.00000000e+00 -1.11022299e-16 -1.11022304e-16 -1.11022304e-16]
 [ 0.00000000e+00  1.00000000e+00 -2.22044600e-16 -3.05311335e-16]
 [ 0.00000000e+00  0.00000000e+00 -1.00000000e+00 -2.22044600e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e+00]]
Iteration 80 A:
 [[ 1.00000000e+00 -1.11022299e-16 -1.11022304e-16 -1.11022304e-16]
 [ 0.00000000e+00  1.00000000e+00 -2.22044600e-16 -3.05311335e-16]
 [ 0.00000000e+00  0.00000000e+00 -1.00000000e+00 -2.22044600e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e+00]]
Iteration 90 A:
 [[ 1.00000000e+00 -1.11022299e-16 -1.11022304e-16 -1.11022304e-16]
 [ 0.00000000e+00  1.00000000e+00 -2.22044600e-16 -3.05311335e-16]
 [ 0.00000000e+00  0.00000000e+00 -1.00000000e+00 -2.22044600e-16]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.00000000e+00]]
Eigenvalues of A: [ 1.  1. -1. -1.]
```

其中第一行为使用 `numpy` 库计算得到的正确结果。
之后每十轮迭代的结果都会输出，可以发现矩阵 $A$ 逐渐收敛到上三角矩阵。
最后得到的对角线元素即为矩阵 $A$ 的特征值。可以发现结果与第一行一致。

## 上机题4

